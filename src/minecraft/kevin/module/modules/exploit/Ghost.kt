package kevin.module.modules.exploit

import kevin.event.EventTarget
import kevin.event.UpdateEvent
import kevin.module.Module
import kevin.module.ModuleCategory
import kevin.utils.ChatUtils
import net.minecraft.client.gui.GuiGameOver

class Ghost : Module("Ghost", "Allows you to walk around and interact with your environment after dying.", category = ModuleCategory.EXPLOIT) {

    private var isGhost = false

    @EventTarget
    fun onUpdate(event: UpdateEvent) {
        val thePlayer = mc.thePlayer ?: return

        if ((mc.currentScreen)is GuiGameOver) {
            mc.displayGuiScreen(null)
            thePlayer.isDead = false
            thePlayer.health = 20F
            thePlayer.setPositionAndUpdate(thePlayer.posX, thePlayer.posY, thePlayer.posZ)
            isGhost = true

            ChatUtils().message("Â§cYou are now a ghost.")
        }
    }

    override fun onDisable() {
        val thePlayer = mc.thePlayer

        if (isGhost && thePlayer != null) {
            thePlayer.respawnPlayer()
            isGhost = false
        }
    }

}